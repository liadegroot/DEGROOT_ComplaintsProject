---
title: "2021 Consumer Complaints"
author: "Lia DeGroot"
date: "5/6/2022"
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: scroll

---


```{r setup, include=FALSE}

`complaints (1)` <- readRDS("~/Desktop/github_lia/DEGROOT_GITHUBHOMEWOKR/complaints (1).rds")

library(tidyverse)
library(janitor)
library(readxl)
library(scales)
library(lubridate)
library(ggthemes)
library(esquisse)
library(dplyr)
library(ggplot2)
library(flexdashboard)
library(kableExtra)
library(stringr)
library(knitr)

```


```{r}

complaints_bydate <- `complaints (1)` %>% 
  count(date_received)
```

Column

 -------------------------------------
    
### Chart 1 
    
```{r}
`complaints (1)`$Month <- lubridate::month(`complaints (1)`$date_received)

monthcount <- count(`complaints (1)`, Month)

ggplot(monthcount, aes(x = Month, y = n)) + 
 geom_line(color = "#F28C28") + labs(title = "Monthly Consumer Complaints", 
                    subtitle = "Total number of consumer complaints per month in 2021"
                      , y = "Number of complaints") + theme(panel.grid = element_line(color = "#8ccde3",
                                  size = 0.75,
                                  linetype = 2))
```
   

Column

 -------------------------------------
   
### Chart 2 


```{r}

complaints_byproduct <- `complaints (1)` %>% 
  count(product)
ggplot(complaints_byproduct, aes(x = product, y = n)) +
  geom_col(color = "#F28C28", fill = "#F28C28") +
  coord_flip() +
  labs(title = "Consumer Compaints by Product", 
                    subtitle = "Total number of consumer complints by product 
                    in 2021"
                      , y = "Number of complaints", x = "Type of product") + 
  theme(panel.grid = element_line(color = "#8ccde3",
                                  size = 0.75,
                                  linetype = 2)) + 
                          theme(axis.text = element_text(size = 5)) +
  scale_x_discrete(labels = wrap_format(8))
 

```   
 
 Column

 -------------------------------------

### Chart 3 
    
```{r}
complaints_bystate <- `complaints (1)` %>% 
  count(state) 

 
```

```{r, results='asis'}
complaints_bystate %>% 
  knitr::kable(caption = "Consumer Complaints by State") %>% 
  kableExtra::kable_styling(bootstrap_options = "striped")
 
```
